<?xml version='1.0' encoding='UTF-8'?>
<MorpheusModel version="4">
    <Description>
        <Title>Example-RunAndTumble</Title>
        <Details>Models a Levy walk - a random walk strategy that is superior for searching due to it's high spatial coverage.

Shows how to manipulate PropertyVectors (x,z,y) using the VectorRule. An expression for each of the three coordinates must be given, separated by a comma ",".</Details>
    </Description>
    <Global>
        <!--    <Disabled>
        <Variable symbol="angle" value="0.0"/>
    </Disabled>
-->
        <Constant symbol="dummy" value="0.0"/>
    </Global>
    <Space>
        <Lattice class="square">
            <Size symbol="size" value="400 400 0"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <BoundaryConditions>
                <Condition boundary="x" type="periodic"/>
                <Condition boundary="y" type="periodic"/>
            </BoundaryConditions>
        </Lattice>
        <SpaceSymbol symbol="space"/>
    </Space>
    <Time>
        <StartTime value="0"/>
        <StopTime value="1000"/>
        <TimeSymbol symbol="time"/>
    </Time>
    <CellTypes>
        <CellType class="biological" name="amoeba">
            <VolumeConstraint target="200" strength="1"/>
            <Property symbol="theta" value="0.0"/>
            <ConnectivityConstraint/>
            <Property symbol="angle" value="rand_norm(pi/2,pi/2)"/>
            <PropertyVector symbol="move_dir" value="0.0, 0.0, 0.0"/>
            <!--    <Disabled>
        <System solver="euler" time-scaling="10" time-step="0.01">
            <Constant symbol="tau" value=".9999"/>
            <Constant symbol="D" value="pi/10"/>
            <Disabled>
                <DiffEqn symbol-ref="angle">
                    <Expression>-tau*angle - D*rand_norm(0,1)</Expression>
                </DiffEqn>
            </Disabled>
            <DiffEqn symbol-ref="angle">
                <Expression>tau * angle + D * rand_norm(0,1)</Expression>
            </DiffEqn>
            <VectorRule symbol-ref="move_dir" spherical="true">
                <Expression>angle, 0, 1</Expression>
            </VectorRule>
        </System>
    </Disabled>
-->
            <!--    <Disabled>
        <DirectedMotion direction="move_dir" strength="0.6"/>
    </Disabled>
-->
            <System solver="euler" time-step="1">
                <Constant symbol="tau" value="0.9999"/>
                <Constant symbol="D" value="pi/16"/>
                <!--    <Disabled>
        <DiffEqn symbol-ref="angle">
            <Expression>tau * angle + D * rand_norm(0,1)</Expression>
        </DiffEqn>
    </Disabled>
-->
                <Rule symbol-ref="angle">
                    <Expression>tau * angle + D * rand_norm(0,1)</Expression>
                </Rule>
                <VectorRule symbol-ref="move_dir" spherical="true">
                    <Expression>angle, 0.0, 1.0</Expression>
                </VectorRule>
            </System>
            <DirectedMotion direction="move_dir" strength="0.2"/>
        </CellType>
        <CellType class="medium" name="medium"/>
    </CellTypes>
    <CPM>
        <Interaction>
            <Contact type1="amoeba" type2="medium" value="4"/>
        </Interaction>
        <MonteCarloSampler stepper="edgelist">
            <MCSDuration value="1"/>
            <Neighborhood>
                <Order>1</Order>
            </Neighborhood>
            <MetropolisKinetics temperature="0.6"/>
        </MonteCarloSampler>
        <ShapeSurface scaling="norm">
            <Neighborhood>
                <Distance>2.5</Distance>
            </Neighborhood>
        </ShapeSurface>
    </CPM>
    <CellPopulations>
        <Population size="1" type="amoeba">
            <!--    <Disabled>
        <Cell id="1" name="1">
            <Nodes>50,100,0</Nodes>
        </Cell>
    </Disabled>
-->
            <InitCircle mode="random" number-of-cells="1">
                <Dimensions radius="20.0" center="200, 200, 0.0"/>
            </InitCircle>
        </Population>
    </CellPopulations>
    <Analysis>
        <Gnuplotter time-step="100" decorate="false">
            <Terminal name="png"/>
            <Plot>
                <Cells min="0.0">
                    <ColorMap>
                        <Color value="0" color="red"/>
                        <Color value="2" color="blue"/>
                    </ColorMap>
                </Cells>
                <CellArrows orientation="5 * move_dir"/>
            </Plot>
        </Gnuplotter>
        <Logger time-step="1">
            <Input>
                <!--    <Disabled>
        <Symbol symbol-ref="move_dir.x"/>
    </Disabled>
-->
                <Symbol symbol-ref="cell.center.x"/>
                <Symbol symbol-ref="cell.center.y"/>
                <!--    <Disabled>
        <Symbol symbol-ref="cell.center.phi"/>
    </Disabled>
-->
                <Symbol symbol-ref="angle"/>
                <!--    <Disabled>
        <Symbol symbol-ref="eps"/>
    </Disabled>
-->
                <Symbol symbol-ref="cell.center.phi"/>
                <Symbol symbol-ref="cell.orientation.phi"/>
            </Input>
            <Output>
                <TextOutput/>
            </Output>
            <Plots>
                <Plot time-step="5000">
                    <Style style="lines" line-width="2.0"/>
                    <Terminal terminal="png"/>
                    <X-axis>
                        <Symbol symbol-ref="time"/>
                    </X-axis>
                    <Y-axis>
                        <Symbol symbol-ref="angle"/>
                    </Y-axis>
                </Plot>
            </Plots>
        </Logger>
    </Analysis>
</MorpheusModel>
